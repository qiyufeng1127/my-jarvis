# 功能测试指南 - 2026-02-09

## 🧪 测试清单

### 1. 通知功能测试

#### 测试步骤：
1. 打开应用，允许通知权限
2. 创建一个任务，设置开始时间为1分钟后
3. 等待任务开始时间到达
4. 检查是否收到通知："📋 任务开始"
5. 检查是否播放提示音

#### 预期结果：
- ✅ 浏览器弹出通知
- ✅ 通知内容包含任务标题
- ✅ 播放开始提示音
- ✅ 点击通知可聚焦窗口

#### 测试任务即将结束通知：
1. 创建一个任务，设置结束时间为3分钟后
2. 等待1分钟（提前2分钟提醒）
3. 检查是否收到通知："⏰ 任务即将结束"

#### 测试任务结束通知：
1. 等待任务结束时间到达
2. 检查是否收到通知："✅ 任务结束"

---

### 2. 语音控制测试

#### 测试步骤：
1. 点击右下角紫色喇叭按钮
2. 点击麦克风按钮开始监听
3. 说："现在正在做什么任务"
4. 检查AI是否语音回复

#### 预期结果：
- ✅ 麦克风按钮变红色并闪烁
- ✅ 实时显示识别的文字
- ✅ AI显示回复文字
- ✅ AI语音播报回复内容

#### 测试其他指令：
- "下一个任务是什么"
- "这个任务过去了多长时间"
- "下个任务还有多长时间开始"
- "删除今天的任务"（需要确认）

---

### 3. 启动验证状态测试

#### 测试步骤：
1. 创建一个任务，启用验证
2. 点击"*start"按钮
3. 拍照完成启动验证
4. 检查按钮是否变成"✅已启动"

#### 预期结果：
- ✅ 按钮文字变为"✅已启动"
- ✅ 按钮背景变为绿色半透明
- ✅ 鼠标悬停显示"已启动验证"
- ✅ 不能重复点击启动验证

---

### 4. 完成验证中文提示测试

#### 测试步骤：
1. 创建任务"上厕所"，启用验证
2. 完成启动验证
3. 点击完成验证
4. 拍摄马桶照片
5. 提交验证

#### 预期结果：
- ✅ 识别到"马桶"、"坐便器"、"卫生间"等关键词
- ✅ 验证通过
- ✅ 显示中文成功提示
- ✅ 显示匹配的物体列表

#### 测试验证失败：
1. 拍摄不相关的照片（如桌子）
2. 提交验证

#### 预期结果：
- ✅ 显示中文失败提示
- ✅ 显示识别到的物体
- ✅ 显示具体的拍摄建议
- ✅ 显示详细的调试信息

---

### 5. 任务监控测试

#### 测试步骤：
1. 创建多个任务，设置不同的开始和结束时间
2. 检查控制台日志
3. 等待任务时间节点到达
4. 检查是否收到通知

#### 预期结果：
- ✅ 控制台显示"✅ [任务监控] 开始监控任务"
- ✅ 任务开始时收到通知
- ✅ 任务即将结束时收到通知（提前2分钟）
- ✅ 任务结束时收到通知
- ✅ 删除任务时停止监控

---

## 🔍 调试技巧

### 查看通知权限状态
```javascript
console.log('通知权限:', Notification.permission);
```

### 手动触发通知
```javascript
import { notificationService } from '@/services/notificationService';
notificationService.notifyTaskStart('测试任务', true);
```

### 查看任务监控状态
```javascript
import { taskMonitorService } from '@/services/taskMonitorService';
// 在控制台查看监控的任务
console.log(taskMonitorService);
```

### 测试语音识别
1. 打开浏览器控制台
2. 检查是否有语音识别错误
3. 确保使用Chrome浏览器（最佳支持）

---

## ⚠️ 常见问题

### 1. 通知不显示
- **原因**：浏览器通知权限未授予
- **解决**：在浏览器设置中允许通知权限

### 2. 语音识别不工作
- **原因**：浏览器不支持或麦克风权限未授予
- **解决**：使用Chrome浏览器，允许麦克风权限

### 3. 验证总是失败
- **原因**：百度API未配置或关键词不匹配
- **解决**：
  - 检查百度API配置
  - 查看调试信息中的识别结果
  - 确保照片清晰且包含相关物品

### 4. 按钮状态不更新
- **原因**：验证状态未正确保存
- **解决**：刷新页面，重新验证

---

## 📊 性能检查

### 内存使用
- 监控定时器数量（不应无限增长）
- 检查是否有内存泄漏

### 网络请求
- 百度API调用次数
- 图片上传大小

### 浏览器兼容性
- Chrome：✅ 完全支持
- Firefox：⚠️ 语音识别可能不支持
- Safari：⚠️ 通知和语音功能可能受限
- Edge：✅ 基本支持

---

## ✅ 测试完成标准

- [ ] 所有通知功能正常工作
- [ ] 语音控制可以识别和回复
- [ ] 启动验证状态正确显示
- [ ] 完成验证显示中文提示
- [ ] 任务监控自动发送通知
- [ ] 没有控制台错误
- [ ] 性能表现良好

---

## 🎉 测试通过后

恭喜！所有功能都已正常工作。现在你可以：

1. 创建任务并体验自动通知
2. 使用语音控制管理任务
3. 享受更智能的验证系统
4. 不再错过任何任务节点

祝使用愉快！🎊








