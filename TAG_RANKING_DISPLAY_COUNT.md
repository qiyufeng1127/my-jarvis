# 标签排行榜显示数量选择功能

## 更新时间
2026-02-09

## 新增功能

### 标签排行榜显示数量选择器

在标签排行榜的右上角（效率等级按钮后面的空白处）添加了一个下拉选择器，让用户可以自定义显示多少个标签。

## 功能特性

### 1. 显示数量选择器

**位置：** 排序按钮右侧的空白区域

**选项：**
- 前5个
- 前10个（默认）
- 前20个
- 前50个
- 全部

### 2. 动态显示

- 用户选择显示数量后，排行榜立即更新
- 只显示选定数量的标签
- 减少页面长度，提升浏览体验

### 3. 统计信息

当有标签未显示时，在列表底部显示：
- 当前显示数量 / 总标签数
- 还有多少个标签未显示
- "显示全部"按钮（快速展开所有标签）

## 界面设计

```
┌─────────────────────────────────────────────────────────┐
│ [⏱️ 累计时长] [🔢 使用次数] [📋 关联任务]              │
│ [💰 收入] [💸 支出] [📊 净收支]                        │
│ [⏰ 时薪] [⚡ 效率等级]          显示 [前10个 ▼]      │
├─────────────────────────────────────────────────────────┤
│ 1️⃣ 💻 编程                                    120h 30m │
│ 2️⃣ 📚 学习                                     80h 15m │
│ 3️⃣ 🏃 运动                                     45h 20m │
│ 4  🎨 设计                                     30h 10m │
│ 5  📝 写作                                     25h 45m │
│ 6  🧹 家务                                     20h 30m │
│ 7  🍳 做饭                                     18h 15m │
│ 8  💪 健身                                     15h 40m │
│ 9  📖 阅读                                     12h 25m │
│ 10 🎮 娱乐                                     10h 50m │
├─────────────────────────────────────────────────────────┤
│ 显示 10 / 72 个标签，还有 62 个未显示                  │
│                  [显示全部]                             │
└─────────────────────────────────────────────────────────┘
```

## 技术实现

### 新增状态

```typescript
const [displayCount, setDisplayCount] = useState<number>(10); // 默认显示10个
```

### 选择器UI

```typescript
<select
  value={displayCount}
  onChange={(e) => setDisplayCount(Number(e.target.value))}
  className="px-2 py-1 rounded-lg text-xs font-medium border"
  style={{
    backgroundColor: cardBg,
    color: textColor,
    borderColor: borderColor,
  }}
>
  <option value={5}>前5个</option>
  <option value={10}>前10个</option>
  <option value={20}>前20个</option>
  <option value={50}>前50个</option>
  <option value={tags.length}>全部</option>
</select>
```

### 列表切片

```typescript
{sortedTags.slice(0, displayCount).map((tag, index) => {
  // 渲染标签卡片
})}
```

### 统计信息

```typescript
{sortedTags.length > displayCount && (
  <div className="mt-4 text-center">
    <p className="text-xs" style={{ color: secondaryColor }}>
      显示 {displayCount} / {sortedTags.length} 个标签，
      还有 {sortedTags.length - displayCount} 个未显示
    </p>
    <button onClick={() => setDisplayCount(sortedTags.length)}>
      显示全部
    </button>
  </div>
)}
```

## 使用场景

### 场景1：快速浏览

用户有72个标签，但只想看前10个最常用的：
1. 选择"前10个"
2. ✅ 只显示前10个标签
3. 页面更简洁，滚动更少

### 场景2：详细分析

用户想查看所有标签的详细排名：
1. 选择"全部"
2. ✅ 显示所有72个标签
3. 可以完整浏览所有数据

### 场景3：快速对比

用户想对比前5名的标签：
1. 选择"前5个"
2. ✅ 只显示前5个标签
3. 更容易对比和分析

## 优势

### 1. **灵活性**
- 用户可以根据需求自定义显示数量
- 5个选项覆盖不同使用场景

### 2. **性能优化**
- 减少渲染的DOM元素
- 提升页面滚动性能
- 特别是标签数量很多时

### 3. **用户体验**
- 减少页面长度
- 更容易找到重要信息
- 避免信息过载

### 4. **空间利用**
- 利用了排序按钮右侧的空白区域
- 界面更紧凑
- 不占用额外空间

## 布局优化

### 修改前：
```
[排序按钮们]                    [空白区域]
```

### 修改后：
```
[排序按钮们]          显示 [前10个 ▼]
```

排序按钮和选择器在同一行，充分利用空间。

## 响应式设计

- 在小屏幕上，选择器会自动换行
- 使用 `flex-wrap` 确保布局不会破坏
- 选择器始终保持可见和可操作

## 默认值

- **默认显示：** 前10个
- **原因：** 平衡了信息量和页面长度
- **可调整：** 用户可以随时更改

## 数据持久化（可选）

未来可以添加：
```typescript
// 保存用户偏好
localStorage.setItem('tag_display_count', displayCount.toString());

// 加载用户偏好
const [displayCount, setDisplayCount] = useState<number>(() => {
  const saved = localStorage.getItem('tag_display_count');
  return saved ? Number(saved) : 10;
});
```

## 修改的文件

**src/components/tags/TagRankingList.tsx**
- 新增 `displayCount` 状态
- 新增显示数量选择器UI
- 修改列表渲染逻辑（使用 `slice`）
- 新增统计信息显示
- 新增"显示全部"快捷按钮

## 测试建议

1. **测试选择器**
   - 选择"前5个"，检查是否只显示5个标签
   - 选择"前10个"，检查是否只显示10个标签
   - 选择"全部"，检查是否显示所有标签

2. **测试统计信息**
   - 当显示数量 < 总数时，检查是否显示统计信息
   - 点击"显示全部"按钮，检查是否展开所有标签

3. **测试排序**
   - 切换不同的排序方式
   - 检查显示数量是否保持不变
   - 检查排名是否正确更新

4. **测试响应式**
   - 在不同屏幕尺寸下测试
   - 检查选择器是否正常显示
   - 检查布局是否合理

## 总结

✅ 在排序按钮右侧添加了显示数量选择器
✅ 支持5个、10个、20个、50个、全部
✅ 默认显示前10个标签
✅ 显示统计信息（当前/总数）
✅ 提供"显示全部"快捷按钮
✅ 充分利用空白区域
✅ 提升用户体验和页面性能

现在标签排行榜更加灵活和易用！用户可以根据需求自定义显示数量，避免页面过长，同时保持完整的数据访问能力。🎉

