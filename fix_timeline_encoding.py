#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""修复 NewTimelineView.tsx 文件中的中文乱码"""

import re

# 读取文件
file_path = 'src/components/calendar/NewTimelineView.tsx'

try:
    # 尝试用 UTF-8 读取
    with open(file_path, 'r', encoding='utf-8', errors='ignore') as f:
        content = f.read()
    
    # 定义需要替换的乱码和对应的正确中文
    replacements = [
        ('����Ƿ�Ϊ�ƶ��豸', '检测是否为移动设备'),
        ('����״̬', '任务状态'),
        ('������֤������', '当前验证的任务'),
        ('��֤����', '验证类型'),
        ('������֤��ʱ���', '开始验证超时标记'),
        ('�����֤��ʱ���', '完成验证超时标记'),
        ('����ʵ������ʱ��', '任务实际开始时间'),
        ('��ȡ�������Ƭ����', '获取拍片任务进度'),
        ('�༭�����״̬', '编辑任务状态'),
        ('ʹ�� AI Store ��ȡ API ����', '使用 AI Store 获取 API 配置'),
        ('ʹ�ý��ϵͳ', '使用金币系统'),
        ('ʹ�ñ�ǩϵͳ', '使用标签系统'),
        ('��ףЧ��״̬', '庆祝效果状态'),
        ('�ж���ɫ�Ƿ�Ϊ��ɫ', '判断颜色是否为深色'),
        ('���ݱ���ɫ��ȡ������ɫ', '根据背景色获取文字颜色'),
        ('ʹ����ʵ���񣨲�����Ҫʾ������', '使用真实任务（不需要示例任务）'),
        ('����ʶ���������ͣ��Ƿ�Ϊ��Ƭ����', '智能识别任务类型：是否为拍片任务'),
        ('ƥ��ģʽ������ + ���ʣ��š������Ρ������ݵȣ�', '匹配模式：数字 + 量词（张、个、次、组、套等）'),
        ('��ȡ����', '获取单位'),
        ('���༭���������', '待编辑的任务标题'),
        ('���������������ܷ�����ɫ - �Ż��棬�����ظ�', '根据任务内容智能分配颜色 - 优化版，避免重复'),
        ('���ȼ��Ӹߵ��ͣ�ȷ����ȷƥ��', '优先级从高到低，确保准确匹配'),
        ('�����/С���鹤�� - ��ɫϵ��������ȼ������ⱻ�������򸲸ǣ�', '拍照/小红书工作 - 紫色系（最高优先级，避免被其他颜色覆盖）'),
        ('ins����/�罻ý����Ӫ - õ��ɫ', 'ins运营/自媒体运营 - 玫瑰色'),
        ('�Ĵ���ƹ��� - ��ɫϵ', '创作设计工作 - 橙色系'),
        ('������ - ��ɫϵ', '学习类 - 蓝色系'),
    ]
    
    # 执行替换
    modified = False
    for old, new in replacements:
        if old in content:
            content = content.replace(old, new)
            modified = True
            print(f'替换: {old[:20]}... -> {new[:20]}...')
    
    if modified:
        # 保存文件
        with open(file_path, 'w', encoding='utf-8') as f:
            f.write(content)
        print(f'\n✓ 文件已修复并保存: {file_path}')
    else:
        print('未找到需要替换的乱码')
        
except Exception as e:
    print(f'错误: {e}')

